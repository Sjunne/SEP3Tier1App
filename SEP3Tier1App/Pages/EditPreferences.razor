@page "/Editpreference"
@using WebApplication.Data
@using WebApplication.Network
@using System.Diagnostics.Eventing.Reader
@using System.Text.Json
@using SEP3Tier1App.CustomAttributes
@inject ProfileData ProfileData
@inject INetworkComp Network
<h1>Edit preferences.</h1>
<EditForm Model="ProfileData.preferences" OnValidSubmit="@ConfirmData">
<DataAnnotationsValidator />
<ValidationSummary />
<label>Maximum Age</label>
<InputNumber class="form-control" placeholder="MaxAge" @bind-Value="@ProfileData.preferences.maximumAge"/>
<label>Minimum Age</label>
<InputNumber class="form-control" placeholder="MinAge" @bind-Value="@ProfileData.preferences.minimumAge"/>
<div>
    <label>Education</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="Education" @bind-Value="@education"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.education == null) {if (education.Any(char.IsDigit)){} else{ ProfileData.preferences.education += education;}} else {if (education.Any(char.IsDigit)){} else{ProfileData.preferences.education += ", " + education;}} education = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have chosen: @ProfileData.preferences.education</label>
</div>
<div>
    <label>City</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="City" @bind-Value="@city"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.city == null) {if (city.Any(char.IsDigit)){} else{ProfileData.preferences.city += city;}}
                      else { if (city.Any(char.IsDigit)){} else{
                          ProfileData.preferences.city += ", " + city;}}
                                  city = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have chosen: @ProfileData.preferences.city</label>
</div>
<div>
    <label>Hobbies</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="Hobbies" @bind-Value="@hobby"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.hobbies == null) {if (hobby.Any(char.IsDigit)){} else{ProfileData.preferences.hobbies += hobby;}}
                      else { if (hobby.Any(char.IsDigit)){} else{
                          ProfileData.preferences.hobbies += ", " + hobby;}}
                                  hobby = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have chosen: @ProfileData.preferences.hobbies</label>
</div>
<div>
    <label>Hair Colors</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="HairColor" @bind-Value="@hairColor"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.hairColor == null) {if (hairColor.Any(char.IsDigit)){} else{ProfileData.preferences.hairColor += hairColor;}}
                      else { if (hairColor.Any(char.IsDigit)){} else {
                          ProfileData.preferences.hairColor += ", " + hairColor;}}
                                  hairColor = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have chosen: @ProfileData.preferences.hairColor</label>
</div>
<div>
    <label>Eye Colors</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="EyeColor" @bind-Value="@eyeColor"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.eyeColor == null) {if (eyeColor.Any(char.IsDigit)){} else{ ProfileData.preferences.eyeColor += eyeColor;}}
                      else { if (eyeColor.Any(char.IsDigit)){} else {
                          ProfileData.preferences.eyeColor += ", " + eyeColor;}}
                                  eyeColor = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have: @ProfileData.preferences.eyeColor</label>
</div>
<div>
    <label>Skin Colors</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="SkinColor" @bind-Value="@skinColor"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.skinColor == null) {if (skinColor.Any(char.IsDigit)){} else {ProfileData.preferences.skinColor += skinColor;}}
                                  else { if (skinColor.Any(char.IsDigit)){} else{
                                      ProfileData.preferences.skinColor += ", " + skinColor;}}
                                  skinColor = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have: @ProfileData.preferences.skinColor</label>
</div>
<div>
    <label>Nationalities</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="Nationality" @bind-Value="@nationality"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.nationality == null) {if (nationality.Any(char.IsDigit)){} else {ProfileData.preferences.nationality += nationality;}}
                      else { if (nationality.Any(char.IsDigit)){} else {
                          ProfileData.preferences.nationality += ", " + nationality;}}
                                  nationality = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have: @ProfileData.preferences.nationality</label>
</div>
<div>
    <label>Bodyshape</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="BodyShape" @bind-Value="@bodyshape"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.bodyShape == null) {if (bodyshape.Any(char.IsDigit)){} else { ProfileData.preferences.bodyShape += bodyshape;}}
                      else { if (bodyshape.Any(char.IsDigit)){} else {
                          ProfileData.preferences.bodyShape += ", " + bodyshape;}}
                                  bodyshape = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have: @ProfileData.preferences.bodyShape</label>
</div>
<div>
    <label>Jobs</label><br>
    <label style="font-size: xx-small">You cannot enter numbers</label>
    <InputText class="form-control" placeholder="Job" @bind-Value="@job"/>
    <button type="button" @onclick="@(() => { if (ProfileData.preferences.job == null) {if (job.Any(char.IsDigit)){} else {ProfileData.preferences.job += job;}}
                      else { if (job.Any(char.IsDigit)){} else {
                          ProfileData.preferences.job += ", " + job;}}
                                  job = ""; })">
        <i class="oi oi-plus" style="color:red"/>
        Add</button>
    <label>So far you have: @ProfileData.preferences.job</label>
</div>
<div>
    <label>Genders</label>
    <InputText class="form-control" placeholder="Gender" @bind-Value="@ProfileData.preferences.gender"/>
</div>

<div>
    <label>Do you want them to have kids?</label>
    <input type="checkbox" @bind="@ProfileData.preferences.kids"/>
</div>
<div>
    <label>Seeks Relationship</label>
    <input type="checkbox" @bind="@ProfileData.preferences.lookingFor"/>
</div>


<button>
    <i class="oi oi-submit" style="color:red"/>
    Submit</button>
</EditForm>

@code {
    private string hobby;
    private string hairColor;
    private string eyeColor;
    private string skinColor;
    private string nationality;
    private string job;
    private string bodyshape; 
    private string gender;
    private string education;
    private string city;
    private EditContext editContext;

    protected override async Task OnInitializedAsync()
    {
        ProfileData = await Network.GetPreference("Kasper");
        ProfileData.preferences=JsonSerializer.Deserialize<Details>(ProfileData.jsonPref);
        editContext = new EditContext(ProfileData.preferences);
        Console.WriteLine(ProfileData.username);
        
    }

    public void ConfirmData()
    {
        Boolean isValid = editContext.Validate();

        if (isValid)
        {
            ProfileData.username = "Kasper";
            Network.EditPreference(ProfileData);
        }
       
    }
    
}